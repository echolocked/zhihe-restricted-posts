(()=>{var t={n:e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},d:(e,r)=>{for(var s in r)t.o(r,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:r[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};(()=>{"use strict";const e=flarum.core.compat["common/extend"],r=flarum.core.compat["forum/app"];var s=t.n(r);const o=flarum.core.compat["forum/components/Post"];var c=t.n(o);const i=flarum.core.compat["forum/components/CommentPost"];var a=t.n(i);const n=flarum.core.compat["common/components/Button"];var d=t.n(n);const u=flarum.core.compat["forum/components/DiscussionComposer"];var p=t.n(u);const f=flarum.core.compat["forum/components/ReplyComposer"];var l=t.n(f);const h=flarum.core.compat["forum/utils/PostControls"];var k=t.n(h);s().initializers.add("zhihe-restricted-posts",function(){(0,e.extend)(a().prototype,"headerItems",function(t){var e=this.attrs.post;e&&e.attribute("isRestricted")&&t.add("restrictedBadge",m("span",{className:"RestrictedBadge",title:s().translator.trans("zhihe-restricted-posts.forum.restricted_post")},m("i",{className:"fas fa-lock"})),70)}),(0,e.extend)(k(),"userControls",function(t,e,r){var o=s().session.user;o&&o.id()===e.user().id()&&(e.attribute("isRestricted")?t.add("unmarkRestricted",d().component({icon:"fas fa-unlock",onclick:function(){r.unmarkAsRestricted()}},s().translator.trans("zhihe-restricted-posts.forum.unmark_restricted")),90):t.add("markRestricted",d().component({icon:"fas fa-lock",onclick:function(){r.markAsRestricted()}},s().translator.trans("zhihe-restricted-posts.forum.mark_restricted")),90))}),(0,e.extend)(c().prototype,"oninit",function(){var t=this;this.markAsRestricted=function(){var e=t.attrs.post;s().request({method:"POST",url:s().forum.attribute("apiUrl")+"/posts/"+e.id()+"/mark-restricted"}).then(function(){e.pushAttributes({isRestricted:!0}),m.redraw()}).catch(function(t){console.error("Failed to mark post as restricted:",t)})},this.unmarkAsRestricted=function(){var e=t.attrs.post;s().request({method:"DELETE",url:s().forum.attribute("apiUrl")+"/posts/"+e.id()+"/unmark-restricted"}).then(function(){e.pushAttributes({isRestricted:!1}),m.redraw()}).catch(function(t){console.error("Failed to unmark post as restricted:",t)})}}),(0,e.extend)(p().prototype,"headerItems",function(t){var e=this;t.add("isRestricted",m("div",{className:"Form-group"},[m("label",{className:"checkbox"},[m("input",{type:"checkbox",checked:this.composer.fields.isRestricted||!1,onchange:function(t){e.composer.fields.isRestricted=t.target.checked}})," ",s().translator.trans("zhihe-restricted-posts.forum.restricted_checkbox")])]),9)}),(0,e.extend)(l().prototype,"headerItems",function(t){var e=this;t.add("isRestricted",m("div",{className:"Form-group"},[m("label",{className:"checkbox"},[m("input",{type:"checkbox",checked:this.composer.fields.isRestricted||!1,onchange:function(t){e.composer.fields.isRestricted=t.target.checked}})," ",s().translator.trans("zhihe-restricted-posts.forum.restricted_checkbox")])]),9)}),(0,e.extend)(p().prototype,"data",function(t){t.isRestricted=this.composer.fields.isRestricted||!1}),(0,e.extend)(l().prototype,"data",function(t){t.isRestricted=this.composer.fields.isRestricted||!1})})})(),module.exports={}})();
//# sourceMappingURL=forum.js.map